{% extends "base.html" %}

{% block title %}工具6：小红书/微博无水印视频下载{% endblock %}

{% block header %}小红书 & 微博无水印视频下载神器（2025最新·永久有效）{% endblock %}

{% block content %}
<style>
    .input-area { display: flex; gap: 15px; margin-bottom: 30px; align-items: center; }
    input { flex: 1; padding: 16px 20px; font-size: 16px; border: 2px solid #e1e5e9; border-radius: 12px; outline: none; transition: all 0.3s; }
    input:focus { border-color: #0066ff; box-shadow: 0 0 0 4px rgba(0,102,255,0.1); }
    button { padding: 16px 40px; background: #0066ff; color: white; border: none; border-radius: 12px; font-size: 18px; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(0,102,255,0.3); }
    button:hover { background: #0055cc; transform: translateY(-2px); }
    .video-container { text-align: center; margin: 30px 0; background: #000; border-radius: 16px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    video { max-width: 100%; max-height: 70vh; border-radius: 16px; }
    .download-btn { display: inline-block; margin: 20px auto; padding: 14px 36px; background: #00c853; color: white; border-radius: 50px; font-size: 18px; text-decoration: none; box-shadow: 0 6px 20px rgba(0,200,83,0.4); transition: all 0.3s; }
    .download-btn:hover { background: #00b140; transform: translateY(-3px); }
    .tips { background: #f0f8ff; padding: 20px; border-radius: 12px; border-left: 5px solid #0066ff; font-size: 15px; color: #555; margin-top: 30px; }
</style>

<div class="input-area">
    <input type="text" id="url" placeholder="粘贴小红书或微博视频链接（支持含 xsec_token 的分享链接）" value="">
    <button onclick="download()">开始下载</button>
</div>

<div id="result"></div>

<div class="tips">
    <strong>使用提示：</strong><br>
    • 支持小红书所有视频（包括私密分享链接）<br>
    • 支持微博公开视频（登录态更稳）<br>
    • 下载后自动播放 + 一键保存原画质 MP4<br>
    • 完全免费，无限次使用，永不失效
</div>

<script>
async function download() {
    const url = document.getElementById('url').value.trim();
    if (!url) return alert('请先粘贴视频链接！');
    
    const result = document.getElementById('result');
    result.innerHTML = '<p style="text-align:center;color:#666;padding:40px;">解析中，请稍等...</p>';
    
    const res = await fetch('/api/download', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: new URLSearchParams({'url': url})
    });
    const data = await res.json();
    
    if (data.success) {
        result.innerHTML = `
            <div class="video-container">
                <video src="${data.file}" controls autoplay playsinline>
                    您的浏览器不支持视频播放
                </video>
            </div>
            <div style="text-align:center;">
                <a href="${data.file}" download class="download-btn">
                    点击下载 MP4（原画质）
                </a>
            </div>
            <p style="text-align:center;color:#00c853;font-size:18px;margin-top:20px;">
                下载成功！文件名：${data.title || '视频'}
            </p>`;
    } else {
        result.innerHTML = `<p style="color:red;text-align:center;">下载失败：${data.error}</p>`;
    }
}
</script>
{% endblock %}
